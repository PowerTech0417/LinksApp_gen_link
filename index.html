<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ” ç”Ÿæˆä¸“å±ä¸‹è½½é“¾æ¥</title>
<style>
  body {
    font-family: system-ui, sans-serif;
    padding: 2em;
    max-width: 600px;
    margin: auto;
    background: radial-gradient(circle at top, #101825, #050910);
    color: #eaf0ff;
  }
  h1 { text-align: center; color: #00e0ff; }
  label { display:block; margin-top:1em; font-weight:bold; }
  input, select { width:100%; padding:8px; border-radius:6px; border:none; margin-top:4px; }
  button { padding:10px 16px; margin-top:1em; border:none; border-radius:8px; cursor:pointer; background:#00e0ff; color:#001; }
  pre { background:#000a1a; padding:10px; border-radius:8px; margin-top:10px; overflow-x:auto; }
</style>
</head>
<body>
  <h1>ğŸ” ä¸‹è½½é“¾æ¥ç”Ÿæˆå™¨</h1>

  <label>Worker ç½‘å€ï¼ˆCloudflareï¼‰</label>
  <input id="baseUrl" type="url" value="https://shortenworld.com/" />

  <label>UIDï¼ˆç”¨æˆ·ä»£å·ï¼‰</label>
  <input id="uid" type="text" value="user123" />

  <label>ä¸‹è½½ç‰ˆæœ¬ï¼ˆåŒºï¼‰</label>
  <select id="zone">
    <option value="1">ç‰ˆæœ¬ 1</option>
    <option value="2">ç‰ˆæœ¬ 2</option>
    <option value="3">ç‰ˆæœ¬ 3</option>
    <option value="4">ç‰ˆæœ¬ 4</option>
    <option value="5">ç‰ˆæœ¬ 5</option>
  </select>

  <label>ç­¾åå¯†é’¥ï¼ˆå¿…é¡»ä¸ Worker ä¸€è‡´ï¼‰</label>
  <input id="secret" type="text" value="mySuperSecretKey" />

  <button id="generate">ç”Ÿæˆä¸“å±é“¾æ¥</button>

  <pre id="output">ç­‰å¾…ç”Ÿæˆ...</pre>

<script>
async function hmacSha256Hex(key, text) {
  const enc = new TextEncoder();
  const cryptoKey = await crypto.subtle.importKey(
    "raw", enc.encode(key),
    { name: "HMAC", hash: "SHA-256" },
    false, ["sign"]
  );
  const sig = await crypto.subtle.sign("HMAC", cryptoKey, enc.encode(text));
  return Array.from(new Uint8Array(sig)).map(b => b.toString(16).padStart(2,"0")).join("");
}

document.getElementById("generate").addEventListener("click", async () => {
  const base = document.getElementById("baseUrl").value.trim();
  const uid = document.getElementById("uid").value.trim();
  const zone = document.getElementById("zone").value.trim();
  const secret = document.getElementById("secret").value.trim();
  if (!base || !uid || !secret) return alert("è¯·å¡«å†™å®Œæ•´ä¿¡æ¯");

  const sig = await hmacSha256Hex(secret, `${uid}:${zone}`);
  const final = `${base}?uid=${encodeURIComponent(uid)}&zone=${zone}&sig=${sig}`;

  document.getElementById("output").textContent = final;
});
</script>
</body>
</html>
